## 目录
```
### 第9章 用正则表达式进行搜索...51
#### 9.1 正则表达式介绍 ...................51
#### 9.2 使用MySQL正则表达式.......52
* 9.2.1 基本字符匹配...........52
* 9.2.2 进行OR匹配 ..............54
* 9.2.3 匹配几个字符之一...54
* 9.2.4 匹配范围...................55
* 9.2.5 匹配特殊字符...........56
* 9.2.6 匹配字符类...............58
* 9.2.7 匹配多个实例...........58
* 9.2.8 定位符.......................59
#### 9.3 小结.......................................61
```



## 第9章 用正则表达式进行搜索...51
* 在 MySQL `WHERE` 子句内使用 **REGEXP** 关键字来正则表达式来更好地控制数据过滤

### 9.1 正则表达式介绍 ...................51
* 正则表达式的作用是匹配文本，将一个模式（正则表达式）与一个文本串进行比较。

### 9.2 使用MySQL正则表达式.......52
* MySQL 用 `WHERE` 子句对正则表达式提供了 *初步的支持*,允许你指定正则表达式,过滤 `SELECT` 检索出的数据。

#### 9.2.1 基本字符匹配...........52
* `... WHERE prod_name REGEXP '1000';`
    * 除关键字 `LIKE` 被 `REGEXP` 替代外，这条语句看上去非常像使用 `LIKE` 的语句 

* `... WHERE prod_name REGEXP '.000';`
    * 这里使用了正则表达式 `.000`。`.` 是正则表达式语言中一个特殊的字符。它表示 *匹配任意一个字符*

* 匹配不区分大小写:
    * 为区分大小写，可使用 `BINARY` 关键字，如 `WHERE prod_name REGEXP BINARY 'JetPack .000';`


#### 9.2.2 进行OR匹配 ..............54
* 为搜索两个串之一（或者为这个串，或者为另一个串），使用 `|`

* `... WHERE prod_name REGEXP '1000|2000';`
    * 正则表达式的 OR 操作符。它表示匹配其中之一

* 两个以上的 OR 条件 也是没有问题的

#### 9.2.3 匹配几个字符之一...54
* 想匹配特定的字符, 可通过指定一组用 `[` 和 `]` 括起来的字符来完成

* `... WHERE prod_name REGEXP '[123] Ton';`
    * 正则表达式 `[123] Ton`。`[123]` 定义 *一组字符* ，它的意思是匹配1 或2 或3

* 正如所见，`[]` 是另一种形式的 `OR` 语句 (然而还是有些差别的)

#### 9.2.4 匹配范围...................55
* 集合可用来定义要匹配的一个或多个字符

* eg: `[a-z]` 匹配任意字母字符

#### 9.2.5 匹配特殊字符...........56
* 为了匹配特殊字符，必须用 `\\` 为前导。`\\-` 表示查找 `-`，`\\.` 表示查找 `.`

* 也就是 **转义（escaping）**

* 匹配`\` 为了匹配反斜杠（`\`）字符本身，需要使用 `\\\`

* 多数正则表达式实现使用单个反斜杠转义特殊字符，以便能使用这些字符本身。但 MySQL 要求两个反斜杠

#### 9.2.6 匹配字符类...............58
* 存在找出你自己经常使用的 *数字、所有字母字符或所有数字字母字符等* 的匹配。为更方便工作，可以使用预定义的字符集，称为 **字符类（character class）**

* 字符类:
```mysql
[:alnum:]       任意字母和数字（同[a-zA-Z0-9]）
[:alpha:]       任意字符（同[a-zA-Z]）
[:blank:]       空格和制表（同[\\t]）
[:cntrl:]       ASCII控制字符（ASCII 0到31和127）
[:digit:]       任意数字（同[0-9]）
[:graph:]       与[:print:]相同，但不包括空格
[:lower:]       任意小写字母（同[a-z]）
[:print:]       任意可打印字符
[:punct:]       既不在[:alnum:]又不在[:cntrl:]中的任意字符
[:space:]       包括空格在内的任意空白字符（同[\\f\\n\\r\\t\\v]）
[:upper:]       任意大写字母（同[A-Z]）
[:xdigit:]      任意十六进制数字（同[a-fA-F0-9]）
```

#### 9.2.7 匹配多个实例...........58
* 目前为止使用的所有正则表达式都试图匹配单次出现

* 有时需要对匹配的数目进行更强的控制, 可以用表如下列出的正则表达式 **重复元字符** 来完成:
```mysql
元字符       说明
*           0个或多个匹配
+           1个或多个匹配（等于{1,}）
?           0个或1个匹配（等于{0,1}）
{n}         指定数目的匹配
{n,}        不少于指定数目的匹配
{n,m}       匹配数目的范围（m不超过255）
```

* eg: `... WHERE prod_name REGEXP '\\(0-9) sticks?\\)';`
    * 正则表达式 `\\([0-9] sticks?\\)` 需要解说一下。\\(匹配)，`[0-9]` 匹配任意数字，`sticks?` 匹配stick 和 sticks（*s 后的 `?` 使 s 可选，因为 ? 匹配它前面的任何字符的0次或1次出现*），\\)匹配)。

* eg: `... WHERE prod_name REGEXP '[[:digit:]]{4}';`
    * `[:digit:]` 匹配任意数字，因而它为数字的一个集合。`{4}` 确切地要求它前面的字符（任意数字）出现4次，所以 `[[:digit:]]{4}` 匹配连在一起的任意4位数字

#### 9.2.8 定位符.......................59
* 目前为止的所有例子都是匹配一个串中任意位置的文本

* 为了匹配特定位置的文本，需要使用如下列出的 **定位符**:
```mysql
元字符          说明
^               文本的开始
$               文本的结尾
[[:<:]]         词的开始
[[:>:]]         词的结尾
```

* 例如，你想找出以一个数（包括以小数点开始的数）开始的所有产品:
    *  `... WHERE prod_name REGEXP '^[0-9\\.]';`

    * `^` 匹配串的开始。因此，`^[0-9\\.]` 只在 `.` 或任意数字为串中第一个字符时才匹配它们

* **`^` 的双重用途**: `^`有两种用法
    * 在集合中（用 `[` 和 `]` 定义），用它来 *否定* 该集合，
    * 否则，用来指串的 *开始处*

* **使 REGEXP 起类似 LIKE 的作用**
    * `LIKE` 和 `REGEXP` 的不同在于，`LIKE` 匹配整个串而 `REGEXP` 匹配子串
    * 利用定位符，通过用 `^` 开始每个表达式，用 `$` 结束每个表达式，可以使 REGEXP 的作用与 LIKE 一样

* *简单的正则表达式测试*
    * 测试一下你写的正则是否正确
    * REGEX P检查总是返回0（没有匹配）或1（匹配）
    * eg: `SELECT 'hello' REGEXP '[0-9]';` 返回 0, 因为匹配不到

### 9.3 小结.......................................61